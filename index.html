<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>dejavu by IndigoUnited</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">dejavu</h1>
        <p class="header">A set of object-oriented tools for JavaScript</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/IndigoUnited/dejavu/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/IndigoUnited/dejavu/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/IndigoUnited/dejavu">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/IndigoUnited">IndigoUnited</a></p>


      </header>
      <section>
        <h1>dejavu</h1>

<hr><p><a href="http://travis-ci.org/IndigoUnited/dejavu"><img src="https://secure.travis-ci.org/IndigoUnited/dejavu.png" alt="Build Status"></a></p>

<p>Have you ever had the feeling that you're seeing something you've already seen
before? That's the feeling you get when using <code>dejavu</code>.</p>

<p>If you are a developer coming from a language like PHP, Java, ActionScript 3.0,
and others, it's likely that you are already familiar with Object Oriented
Programming. However, JavaScript uses prototypal inheritance which, although
powerful and flexible, can be difficult to understand, and specially to maintain
in large projects.</p>

<p><code>dejavu</code> is a library that delivers classical inheritance on top of JavaScript
prototypal inheritance, making it a breeze to move into JavaScript.</p>

<h2>Why another?</h2>

<p>There are some libraries out there able to shim classical inheritance,
however none offers all the functionality that many programmers require.
Also, even though being one of the most feature rich OOP libraries out there, it has one of the best performances, rivaling with vanilla JS in production.</p>

<h2>Features</h2>

<ul>
<li>Concrete classes</li>
<li>Abstract classes</li>
<li>Interfaces</li>
<li>Mixins (so you can get some sort of multiple inheritance)</li>
<li>Private and protected members</li>
<li>Static members</li>
<li>Constants</li>
<li>Ability to declare true singletons via protected/private constructors</li>
<li>Context binding for functions</li>
<li>Method signature checks</li>
<li>Possible to extend or borrow from vanilla classes</li>
<li>Custom instanceOf with support for Interfaces</li>
<li>Classes and instances are locked by default

<ul>
<li>Functions cannot be added, replaced or deleted</li>
<li>Properties can only be modified</li>
</ul>
</li>
<li>Two builds, <code>regular</code> and <code>AMD</code> based

<ul>
<li>
<code>AMD</code> optimized for speeding up developer workflow, allowing testing
without the need to re-compile everything into a single file</li>
<li>
<code>regular</code> if you are not using <code>AMD</code> in your projects</li>
</ul>
</li>
<li>Two modes for each build, <code>strict</code> and <code>loose</code>

<ul>
<li>
<code>strict</code> best in development, enforcing a lot of checks, making sure you
don't make many typical mistakes</li>
<li>
<code>loose</code> best for production, without checks, improving performance</li>
</ul>
</li>
</ul><p>Users are encouraged to declare
<a href="https://developer.mozilla.org/en/JavaScript/Strict_mode">'use strict'</a> while
using the <code>dejavu</code> in strict mode, otherwise some code might fail silently.
This can happen because <code>dejavu</code> uses <code>Object.freeze</code> and <code>Object.seal</code> to lock
classes and instances, guaranteeing that no one changes the behaviour of your
classes by replacing methods, etc, and possibly breaking your code, making it
really hard to pin point what's wrong. Altough this is the default behavior, it can be changed.
You will read more on it later in this document.</p>

<p><strong>Do not confuse 'use strict' with the dejavu strict mode.</strong></p>

<h2>Works on</h2>

<ul>
<li>IE (6+)</li>
<li>Chrome (4+)</li>
<li>Safari (3+)</li>
<li>Firefox (3.6+)</li>
<li>Opera (9+)</li>
<li>Node.js and Rhino</li>
</ul><h2>Getting started</h2>

<p>The quickest way to start using <code>dejavu</code> in your project, is by simply including
<code>dist/regular/strict/dejavu.js</code> (note that this is in <strong>strict</strong> mode).</p>

<p>If you're developing a <strong>client-side</strong> app, simply put the file in some folder,
and include it in the HTML:</p>

<div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"Content-Type"</span> <span class="na">content=</span><span class="s">"text/html; charset=UTF-8"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"dejavu.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
            <span class="s1">'use strict'</span><span class="p">;</span>

            <span class="c1">// Declare the "Person" class</span>
            <span class="kd">var</span> <span class="nx">Person</span> <span class="o">=</span> <span class="nx">dejavu</span><span class="p">.</span><span class="nx">Class</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
                <span class="nx">_name</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>

                <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">setName</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
                <span class="p">},</span>

                <span class="nx">setName</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">_name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>

                    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
                <span class="p">},</span>

                <span class="nx">getName</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_name</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">});</span>

            <span class="c1">// Create a new instance of person</span>
            <span class="kd">var</span> <span class="nx">indigo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">(</span><span class="s1">'Marco'</span><span class="p">);</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'A new indigo was born,'</span><span class="p">,</span> <span class="nx">indigo</span><span class="p">.</span><span class="nx">getName</span><span class="p">());</span>
        <span class="nt">&lt;/script&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>

<p>This will make a <code>dejavu</code> global available for you.
If you're developing in <strong>Node.js</strong>, install it with <code>npm install dejavu</code> and use it like so:</p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">dejavu</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'dejavu'</span><span class="p">);</span>

<span class="c1">// Declare the "Person" class</span>
<span class="kd">var</span> <span class="nx">Person</span> <span class="o">=</span> <span class="nx">dejavu</span><span class="p">.</span><span class="nx">Class</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
    <span class="nx">_name</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>

    <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setName</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="nx">setName</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>

        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="nx">getName</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_name</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// Create a new instance of person</span>
<span class="kd">var</span> <span class="nx">indigo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">(</span><span class="s2">"Marco"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"A new indigo was born,"</span><span class="p">,</span> <span class="nx">indigo</span><span class="p">.</span><span class="nx">getName</span><span class="p">());</span>
</pre></div>

<p>In node, the default mode running will be the strict mode unless the STRICT environmen
 variable is set to false.
Environment variables can be changed system wide or per process like so:</p>

<div class="highlight"><pre><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">STRICT</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</pre></div>

<h2>Performance</h2>

<p>Since all those nice features and common rules of classic OOP degrade
performance, <code>dejavu</code> has two separates modes, for different stages in the
development.</p>

<p>The <code>strict</code> mode is suitable for <strong>development</strong>, and will do all sorts of
checks, throwing an error when you try to do something considered illegal.</p>

<p><strong>Note that if your project works in strict mode, it will work in loose mode.</strong></p>

<p>As for the <code>loose</code> mode, there is no overhead associated with checks, thus
making it suitable for <strong>production</strong>, since it will be more efficient and
have a <strong>lower memory footprint and filesize</strong>.</p>

<p>Finally, in order to achieve that extra edge, that puts <code>dejavu</code> next to vanilla
JS in terms of performance, you should run the optimizer that is bundled with
the library. Note that this step is completely optional, and <code>dejavu</code> will still
perform faster than the other libraries in most browsers, even if you don't run
the optimizer. The optimizer will analyse your code, and make some improvements
boosting it a bit further.</p>

<p>You can check the benchmarks in <a href="http://jsperf.com/oop-benchmark/58">jsperf</a>
comparing <code>dejavu</code> with other OOP libraries. Note that the loose mode
is used in this test, simulating a production environment, and both the normal
and optimized versions are tested.</p>

<h2>Taking it to another level</h2>

<p>Front-end devs are encouraged to program using the AMD paradigm because of its obvious benefits.
Since dejavu is built upon it, it will integrate seamlessly with your AMD loader.
The easy way to set it up is to define a path for dejavu in your loader config like so:</p>

<div class="highlight"><pre><span class="p">{</span>
   <span class="c1">// Your loader config</span>
   <span class="nx">paths</span><span class="o">:</span> <span class="p">{</span>
       <span class="s1">'dejavu'</span><span class="o">:</span> <span class="s1">'/path/to/dejavu/dist/strict/main'</span>     <span class="c1">// You can switch to the loose mode anytime</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>Then require it and use it:</p>

<div class="highlight"><pre><span class="nx">define</span><span class="p">([</span><span class="s1">'dejavu'</span><span class="p">],</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">dejavu</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// The dejavu variable is an object that contains:</span>
    <span class="c1">// Class</span>
    <span class="c1">// FinalClass</span>
    <span class="c1">// AbstractClass</span>
    <span class="c1">// Interface</span>
    <span class="c1">// instanceOf</span>
    <span class="c1">// options</span>

    <span class="c1">// Example usage</span>
    <span class="kd">var</span> <span class="nx">MyClass</span> <span class="o">=</span> <span class="nx">dejavu</span><span class="p">.</span><span class="nx">Class</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
        <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="c1">// ...</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">MyClass</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<p>If you just want to require specific parts of <code>dejavu</code>, you can do so.
In order to achieve this, you must configure your loader like so:</p>

<div class="highlight"><pre><span class="p">{</span>
    <span class="c1">// Your loader config</span>
    <span class="nx">packages</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s1">'dejavu'</span><span class="p">,</span>
            <span class="nx">location</span><span class="o">:</span> <span class="s1">'/path/to/dejavu/dist/strict'</span>     <span class="c1">// You can switch to the loose mode anytime</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>

<p>With this setup, you can still require the dejavu object like shown above or require specific parts of it:</p>

<div class="highlight"><pre><span class="nx">define</span><span class="p">([</span><span class="s1">'dejavu/Class'</span><span class="p">],</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">Class</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// Example usage</span>
    <span class="kd">var</span> <span class="nx">MyClass</span> <span class="o">=</span> <span class="nx">dejavu</span><span class="p">.</span><span class="nx">Class</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
        <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="c1">// ...</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">MyClass</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<p>As you can see, in this case, only the <code>Class</code> module of <code>dejavu</code> is included,
which means all the other modules are not loaded.</p>

<h2>Syntax</h2>

<h3>Interface definition</h3>

<p>Object interfaces allow you to create code which specifies which methods a class must implement, without having to define how these methods are handled.
Below there's an example of an <em>EventsInterface</em> that has the role of adding event listeners and fire events:</p>

<div class="highlight"><pre><span class="nx">define</span><span class="p">([</span><span class="s1">'dejavu/Interface'</span><span class="p">],</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">Interface</span><span class="p">)</span> <span class="p">{</span>

    <span class="s1">'use strict'</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">EventsInterface</span> <span class="o">=</span> <span class="nx">Interface</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
        <span class="nx">$name</span><span class="o">:</span> <span class="s1">'EventsInterface'</span><span class="p">,</span>                       <span class="c1">// Will make easier to debug mistakes (optional)</span>

        <span class="nx">addListener</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{},</span>

        <span class="nx">removeListener</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">fn</span><span class="p">)</span> <span class="p">{},</span>

        <span class="nx">fireEvent</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span> <span class="p">{}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">EventsInterface</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<p>Interfaces can extend multiple interfaces. They can also define static functions signature.
Be aware that all functions must obey its base signature (see explanation later in this document).</p>

<div class="highlight"><pre><span class="nx">define</span><span class="p">([</span><span class="s1">'path/to/EventsInterface'</span><span class="p">,</span> <span class="s1">'dejavu/Interface'</span><span class="p">],</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">EventsInterface</span><span class="p">,</span> <span class="nx">Interface</span><span class="p">)</span> <span class="p">{</span>

    <span class="s1">'use strict'</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">SomeEventsInterface</span> <span class="o">=</span> <span class="nx">Interface</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
        <span class="nx">$name</span><span class="o">:</span> <span class="s1">'SomeEventsInterface'</span><span class="p">,</span>
        <span class="nx">$extends</span><span class="o">:</span> <span class="nx">EventsInterface</span><span class="p">,</span>   <span class="c1">// This interface extends EventsInterface</span>
                                     <span class="c1">// Interfaces can extend multiple ones, just reference them in an array</span>

        <span class="nx">$statics</span><span class="o">:</span> <span class="p">{</span>                  <span class="c1">// This is how we define statics</span>
            <span class="nx">getTotalListeners</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{}</span>
        <span class="p">}</span>

    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">SomeEventsInterface</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<p>Alternatively, one can extend an interface with the extend() function. The equivalent code of the shown above is:</p>

<div class="highlight"><pre><span class="nx">define</span><span class="p">([</span><span class="s1">'path/to/EventsInterface'</span><span class="p">,</span> <span class="s1">'dejavu/Interface'</span><span class="p">],</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">EventsInterface</span><span class="p">,</span> <span class="nx">Interface</span><span class="p">)</span> <span class="p">{</span>

    <span class="s1">'use strict'</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">SomeEventsInterface</span> <span class="o">=</span> <span class="nx">EventsInterface</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">$name</span><span class="o">:</span> <span class="s1">'SomeEventsInterface'</span><span class="p">,</span>

        <span class="nx">$statics</span><span class="o">:</span> <span class="p">{</span>                  <span class="c1">// This is how we define statics</span>
            <span class="nx">getTotalListeners</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{}</span>
        <span class="p">}</span>

    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">SomeEventsInterface</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<h3>Interface usage example</h3>

<p>A class that implements an interface must define all the interface methods and be compatible with their signature.
You define that a class implements an interface by specifying it in the $implements keyword.
The $implements keyword can be an interface or an array of interfaces.
Following the previous example we can define a concrete class - <em>EventsEmitter</em> - that implements the <em>EventsInterface</em> interface.</p>

<div class="highlight"><pre><span class="nx">define</span><span class="p">([</span>
    <span class="s1">'path/to/EventsInterface'</span><span class="p">,</span>
    <span class="s1">'dejavu/Class'</span>
<span class="p">],</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">EventsInterface</span><span class="p">,</span> <span class="nx">Class</span><span class="p">)</span> <span class="p">{</span>

    <span class="s1">'use strict'</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">EventsEmitter</span> <span class="o">=</span> <span class="nx">Class</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
        <span class="nx">$name</span><span class="o">:</span> <span class="s1">'EventsEmitter'</span><span class="p">,</span>
        <span class="nx">$implements</span><span class="o">:</span> <span class="nx">EventsInterface</span><span class="p">,</span>   <span class="c1">// The class implements the EventsInterface interface</span>
                                        <span class="c1">// You can specify multiple interfaces in an array</span>

        <span class="nx">addListener</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Implementation goes here</span>
        <span class="p">},</span>

        <span class="nx">removeListener</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Implementation goes here</span>
        <span class="p">},</span>

        <span class="nx">fireEvent</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Implementation goes here</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">EventsEmitter</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<h3>Abstract classes</h3>

<p>Classes defined as abstract may not be instantiated, and any class that contains at least one abstract method must also be abstract.
Methods defined as abstract simply declare the method's signature.
When an abstract class implements an interface and doesn't implement some of its methods, those will be automatically declared as abstract.
Below there is an example of an abstract class - <em>AbstractEmitter</em> - that implements all of the <em>EventsInterface</em> interface methods, except the <em>fireEvent()</em> method.</p>

<div class="highlight"><pre><span class="nx">define</span><span class="p">([</span>
    <span class="s1">'path/to/EventsInterface'</span><span class="p">,</span>
    <span class="s1">'dejavu/AbstractClass'</span>
<span class="p">],</span>
<span class="kd">function</span> <span class="p">(</span><span class="nx">EventsInterface</span><span class="p">,</span> <span class="nx">AbstractClass</span><span class="p">)</span> <span class="p">{</span>

    <span class="s1">'use strict'</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">AbstractEventsEmitter</span> <span class="o">=</span> <span class="nx">AbstractClass</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
        <span class="nx">$name</span><span class="o">:</span> <span class="s1">'AbstractEventsEmitter'</span><span class="p">,</span>
        <span class="nx">$implements</span><span class="o">:</span> <span class="nx">EventsInterface</span><span class="p">,</span>   <span class="c1">// The class must implement the EventsInterface</span>

        <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">argument1</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// This is the constructor</span>
            <span class="c1">// Calling new on an abstract class will throw an error</span>
            <span class="c1">// Though a class that extends this abstract class will run this constructor if called</span>
        <span class="p">},</span>

        <span class="nx">addListener</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Implementation goes here</span>
        <span class="p">},</span>

        <span class="nx">removeListener</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Implementation goes here</span>
        <span class="p">},</span>

        <span class="c1">// fireEvent() is not implemented, therefore is automatically declared as abstract</span>

        <span class="nx">$abstracts</span><span class="o">:</span> <span class="p">{</span>                   <span class="c1">// This how we defined abstract methods</span>

            <span class="nx">removeAll</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{},</span>

            <span class="nx">$statics</span><span class="o">:</span> <span class="p">{</span>                 <span class="c1">// We can also define abstract static methods</span>
                <span class="nx">getTotalListeners</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">AbstractEventsEmitter</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<p>Abstract classes can extend other abstract classes or concrete classes while implementing other interfaces.</p>

<div class="highlight"><pre><span class="nx">define</span><span class="p">([</span>
    <span class="s1">'path/to/some/class'</span><span class="p">,</span>
    <span class="s1">'path/to/some/interface'</span><span class="p">,</span>
    <span class="s1">'path/to/other/interface'</span><span class="p">,</span>
    <span class="s1">'dejavu/AbstractClass'</span>
<span class="p">],</span>
<span class="kd">function</span> <span class="p">(</span><span class="nx">SomeClass</span><span class="p">,</span> <span class="nx">SomeInterface</span><span class="p">,</span> <span class="nx">OtherInterface</span><span class="p">,</span> <span class="nx">AbstractClass</span><span class="p">)</span> <span class="p">{</span>

    <span class="s1">'use strict'</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">ComplexAbstractClass</span> <span class="o">=</span> <span class="nx">AbstractClass</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
        <span class="nx">$name</span><span class="o">:</span> <span class="s1">'ComplexAbstractClass'</span><span class="p">,</span>
        <span class="nx">$extends</span><span class="o">:</span> <span class="nx">SomeClass</span><span class="p">,</span>
        <span class="nx">$implements</span><span class="o">:</span> <span class="p">[</span><span class="nx">SomeInterface</span><span class="p">,</span> <span class="nx">OtherInterface</span><span class="p">],</span>

        <span class="cm">/**</span>
<span class="cm">         * Class constructor.</span>
<span class="cm">         */</span>
        <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">argument1</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Call super</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$super</span><span class="p">(</span><span class="nx">argument1</span><span class="p">);</span>

            <span class="c1">// Do other things here</span>
        <span class="p">},</span>

        <span class="nx">$statics</span><span class="o">:</span> <span class="p">{</span>
            <span class="c1">// Some class static members</span>
        <span class="p">},</span>

        <span class="nx">$abstracts</span><span class="o">:</span> <span class="p">{</span>

            <span class="c1">// Some abstract functions</span>

            <span class="nx">$statics</span><span class="o">:</span> <span class="p">{</span>
                <span class="c1">// Some abstract static functions</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">ComplexAbstractClass</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<p>Alternatively, one can extend a concrete or abstract class with the extend() function. The equivalent code of the shown above is:</p>

<div class="highlight"><pre><span class="nx">define</span><span class="p">([</span>
    <span class="s1">'path/to/some/class'</span><span class="p">,</span>
    <span class="s1">'path/to/some/interface'</span><span class="p">,</span>
    <span class="s1">'path/to/other/interface'</span><span class="p">,</span>
    <span class="s1">'dejavu/AbstractClass'</span>
<span class="p">],</span>
<span class="kd">function</span> <span class="p">(</span><span class="nx">SomeClass</span><span class="p">,</span> <span class="nx">SomeInterface</span><span class="p">,</span> <span class="nx">OtherInterface</span><span class="p">,</span> <span class="nx">AbstractClass</span><span class="p">)</span> <span class="p">{</span>

    <span class="s1">'use strict'</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">ComplexAbstractClass</span> <span class="o">=</span> <span class="nx">SomeClass</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">$name</span><span class="o">:</span> <span class="s1">'ComplexAbstractClass'</span><span class="p">,</span>
        <span class="nx">$implements</span><span class="o">:</span> <span class="p">[</span><span class="nx">SomeInterface</span><span class="p">,</span> <span class="nx">OtherInterface</span><span class="p">],</span>

        <span class="cm">/**</span>
<span class="cm">         * Class constructor.</span>
<span class="cm">         */</span>
        <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">argument1</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Call super</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$super</span><span class="p">(</span><span class="nx">argument1</span><span class="p">);</span>

            <span class="c1">// Do other things here</span>
        <span class="p">},</span>

        <span class="nx">$statics</span><span class="o">:</span> <span class="p">{</span>
            <span class="c1">// Some class static members</span>
        <span class="p">},</span>

        <span class="nx">$abstracts</span><span class="o">:</span> <span class="p">{</span>

            <span class="c1">// Some abstract functions</span>

            <span class="nx">$statics</span><span class="o">:</span> <span class="p">{</span>
                <span class="c1">// Some abstract static functions</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">ComplexAbstractClass</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<h3>Concrete classes</h3>

<p>Concrete classes can extend other concrete classes or abstract classes as well as implement several interfaces.
They differ from abstract classes in the way that they can't have abstract methods.
Below is described the full syntax that can be used in concrete and abstract classes.</p>

<div class="highlight"><pre><span class="nx">define</span><span class="p">([</span>
    <span class="s1">'path/to/some/class'</span><span class="p">,</span>
    <span class="s1">'path/to/other/class'</span><span class="p">,</span>
    <span class="s1">'path/to/some/interface'</span><span class="p">,</span>
    <span class="s1">'path/to/other/interface'</span><span class="p">,</span>
    <span class="s1">'dejavu/Class'</span>
<span class="p">],</span>
<span class="kd">function</span> <span class="p">(</span><span class="nx">SomeClass</span><span class="p">,</span> <span class="nx">OtherClass</span><span class="p">,</span> <span class="nx">SomeInterface</span><span class="p">,</span> <span class="nx">OtherInterface</span><span class="p">,</span> <span class="nx">Class</span><span class="p">)</span> <span class="p">{</span>

    <span class="s1">'use strict'</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">ConcreteClass</span> <span class="o">=</span> <span class="nx">Class</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
        <span class="nx">$name</span><span class="o">:</span> <span class="s1">'ConcreteClass'</span><span class="p">,</span>
        <span class="nx">$extends</span><span class="o">:</span> <span class="nx">SomeClass</span><span class="p">,</span>
        <span class="nx">$implements</span><span class="o">:</span> <span class="p">[</span><span class="nx">SomeInterface</span><span class="p">,</span> <span class="nx">OtherInterface</span><span class="p">],</span>
        <span class="nx">$borrows</span><span class="o">:</span> <span class="nx">OtherClass</span><span class="p">,</span>                           <span class="c1">// We can add mixins by specifying them in here</span>
                                                        <span class="c1">// You can specify multiple mixins in an array</span>

        <span class="cm">/**</span>
<span class="cm">         * Class constructor.</span>
<span class="cm">         */</span>
        <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="c1">// Call super</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$super</span><span class="p">();</span>

            <span class="c1">// Do other things here</span>
        <span class="p">},</span>

        <span class="nx">$statics</span><span class="o">:</span> <span class="p">{</span>
            <span class="c1">// Some class static members</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>

<h3>Mixins</h3>

<p>A mixin is a class or object that provides a certain functionality to be reused by other classes, since all their members will be copied (expect for the initialize method).
Mixins can be used like specified in the example above.
If clashes occur with multiple mixins, that last one takes precedence.</p>

<h3>Binds</h3>

<p>The $bind() function allows you to bind a anonymous functions to the instance to preserve the context as well as allowing private/protected methods invocations.</p>

<div class="highlight"><pre><span class="nx">define</span><span class="p">([</span>
    <span class="s1">'dejavu/Class'</span>
<span class="p">],</span>
<span class="kd">function</span> <span class="p">(</span><span class="nx">Class</span><span class="p">)</span> <span class="p">{</span>

    <span class="s1">'use strict'</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">ConcreteClass</span> <span class="o">=</span> <span class="nx">Class</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
        <span class="nx">$name</span><span class="o">:</span> <span class="s1">'ConcreteClass'</span><span class="p">,</span>

        <span class="cm">/**</span>
<span class="cm">         * Constructor.</span>
<span class="cm">         */</span>
        <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">element</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'caught click'</span><span class="p">);</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_doSomething</span><span class="p">();</span>
            <span class="p">}.</span><span class="nx">$bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>                                                    <span class="c1">// Use the $bind</span>

            <span class="nx">element</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'keydown'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">$bind</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'caught keydown'</span><span class="p">);</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_doSomething</span><span class="p">();</span>                                           <span class="c1">// Use the this.$bind (same behavior as above)</span>
            <span class="p">});</span>
        <span class="p">},</span>

        <span class="cm">/**</span>
<span class="cm">         * Some protected method</span>
<span class="cm">         */</span>
        <span class="nx">_doSomething</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="c1">// ..</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>

<p>Alternatively, the $bound() function allows you to bind a class function to the instance.
This is useful if certain functions are meant to be used as callbacks or handlers.
You don't need to bind the function manually, it will be bound for you automatically.</p>

<div class="highlight"><pre><span class="nx">define</span><span class="p">([</span>
    <span class="s1">'dejavu/Class'</span>
<span class="p">],</span>
<span class="kd">function</span> <span class="p">(</span><span class="nx">Class</span><span class="p">)</span> <span class="p">{</span>

    <span class="s1">'use strict'</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">ConcreteClass</span> <span class="o">=</span> <span class="nx">Class</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
        <span class="nx">$name</span><span class="o">:</span> <span class="s1">'ConcreteClass'</span><span class="p">,</span>

        <span class="cm">/**</span>
<span class="cm">         * Constructor.</span>
<span class="cm">         */</span>
        <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">element</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_handleClick</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="cm">/**</span>
<span class="cm">         * Handles some click event.</span>
<span class="cm">         */</span>
        <span class="nx">_handleClick</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="c1">// Handle click here</span>
        <span class="p">}.</span><span class="nx">$bound</span><span class="p">()</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>

<h3>Constants</h3>

<p>The $constants keyword allows you to defined constants.
If Object.defineProperty is available, any attempt to modify the constant value will throw an error (only in the strict mode).
Constants can be defined in classes, abstract classes and interfaces.</p>

<div class="highlight"><pre><span class="nx">define</span><span class="p">([</span><span class="s1">'dejavu/Class'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">Class</span><span class="p">)</span> <span class="p">{</span>

    <span class="s1">'use strict'</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">SomeClass</span> <span class="o">=</span> <span class="nx">Class</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
        <span class="nx">$name</span><span class="o">:</span> <span class="s1">'SomeClass'</span><span class="p">,</span>

        <span class="nx">$constants</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">FOO</span><span class="o">:</span> <span class="s1">'bar'</span>
            <span class="nx">BAR</span><span class="o">:</span> <span class="s1">'foo'</span>
        <span class="p">},</span>

        <span class="cm">/**</span>
<span class="cm">         * Class constructor.</span>
<span class="cm">         */</span>
        <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$self</span><span class="p">.</span><span class="nx">FOO</span><span class="p">;</span>    <span class="c1">// 'bar'</span>
            <span class="nx">SomeClass</span><span class="p">.</span><span class="nx">FOO</span><span class="p">;</span>     <span class="c1">// 'bar' (is the same as above)</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="nx">SomeClass</span><span class="p">.</span><span class="nx">FOO</span><span class="p">;</span> <span class="c1">// 'bar'</span>
    <span class="nx">SomeClass</span><span class="p">.</span><span class="nx">BAR</span><span class="p">;</span> <span class="c1">// 'foo'</span>

    <span class="k">return</span> <span class="nx">SomeClass</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<h3>Final members/classes</h3>

<p>Members that are declared as final cannot be overriden by a child class.
If the class itself is being defined final then it cannot be extended.</p>

<div class="highlight"><pre><span class="nx">define</span><span class="p">([</span><span class="s1">'dejavu/FinalClass'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">FinalClass</span><span class="p">)</span> <span class="p">{</span>

    <span class="s1">'use strict'</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">SomeClass</span> <span class="o">=</span> <span class="nx">FinalClass</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>    <span class="c1">// This class cannot be extended</span>
        <span class="nx">$name</span><span class="o">:</span> <span class="s1">'SomeClass'</span><span class="p">,</span>

        <span class="cm">/**</span>
<span class="cm">         * Class constructor.</span>
<span class="cm">         */</span>
        <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="c1">// ...</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">SomeClass</span><span class="p">;</span>
<span class="p">});</span>

<span class="nx">define</span><span class="p">([</span><span class="s1">'dejavu/Class'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">Class</span><span class="p">)</span> <span class="p">{</span>

    <span class="s1">'use strict'</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">SomeClass</span> <span class="o">=</span> <span class="nx">Class</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
        <span class="nx">$name</span><span class="o">:</span> <span class="s1">'SomeClass'</span><span class="p">,</span>

        <span class="cm">/**</span>
<span class="cm">         * Class constructor.</span>
<span class="cm">         */</span>
        <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="c1">// ...</span>
        <span class="p">},</span>

        <span class="nx">$finals</span><span class="o">:</span> <span class="p">{</span>                  <span class="c1">// Classes that extend this one are not allowed to override the members below</span>

            <span class="nx">someMethod</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="c1">// ...</span>
            <span class="p">},</span>
            <span class="nx">someProperty</span><span class="o">:</span> <span class="s1">'foo'</span><span class="p">,</span>

            <span class="nx">$statics</span><span class="o">:</span> <span class="p">{</span>             <span class="c1">// We can also define static methods as final</span>
                <span class="nx">staticMethod</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                    <span class="c1">// ...</span>
                <span class="p">},</span>
                <span class="nx">staticProperty</span><span class="o">:</span> <span class="s1">'bar'</span>
            <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">SomeClass</span><span class="p">;</span>
<span class="p">});</span>

</pre></div>

<h3>Protected and private members</h3>

<p>Protected and private members should be prefixed with _ and __ respectively.
If Object.defineProperty is available, it will be used to manage their access (only in the strict mode).</p>

<h3>Signature check</h3>

<p>All functions are virtual functions, therefore they can be overriden except if they are classified as final.
Additionally, if a method is abstract, a subclass can only implement/override it if they obey their signature (must be equal or augmented with additional optional arguments).
Arguments prefixed with a $ are evaluated as optional. The signature check is done for all abstract functions (interface functions are also considered abstract).</p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">SomeAbstractClass</span> <span class="o">=</span> <span class="nx">AbstractClass</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
    <span class="nx">$abstracts</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">foo</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">param1</span><span class="p">)</span> <span class="p">{}</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">SomeClass</span> <span class="o">=</span> <span class="nx">Class</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
    <span class="nx">$extends</span><span class="o">:</span> <span class="nx">SomeAbstractClass</span><span class="p">,</span>

    <span class="nx">foo</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">param1</span><span class="p">)</span> <span class="p">{</span>             <span class="c1">// Signature is equal, it's valid</span>
        <span class="c1">// Do something here</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">ComplexClass</span> <span class="o">=</span> <span class="nx">Class</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
    <span class="nx">$extends</span><span class="o">:</span> <span class="nx">SomeClass</span><span class="p">,</span>

    <span class="nx">foo</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">param1</span><span class="p">,</span> <span class="nx">$param2</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// Although it's signature is not equal, was augmented with an additional optional argument, so it's valid</span>
        <span class="c1">// Do something here</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">OtherComplexClass</span> <span class="o">=</span> <span class="nx">Class</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
    <span class="nx">$extends</span><span class="o">:</span> <span class="nx">SomeClass</span><span class="p">,</span>

    <span class="nx">foo</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">param1</span><span class="p">,</span> <span class="nx">param2</span><span class="p">)</span> <span class="p">{</span>     <span class="c1">// Will throw an error because foo(param1) is not compatible with foo(param1, param2)</span>
        <span class="c1">// Do something here</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>

<h3>Calling static methods within an instance</h3>

<p>To call static methods inside an instance you can use $self and $static.
$self gives access to the class itself and $static gives access to the called class in a context of static inheritance.
$self is the same as using the class variable itself.</p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">Example1</span> <span class="o">=</span> <span class="nx">Class</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
    <span class="nx">foo</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">param1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">$self</span><span class="p">.</span><span class="nx">bar</span><span class="p">;</span>    <span class="c1">// same as Example1.bar;</span>
    <span class="p">},</span>
    <span class="nx">$statics</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">bar</span><span class="o">:</span> <span class="s1">'hello'</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">Example2</span> <span class="o">=</span> <span class="nx">Class</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
    <span class="nx">foo</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">param1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">$static</span><span class="p">.</span><span class="nx">bar</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">$statics</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">bar</span><span class="o">:</span> <span class="s1">'hello'</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">Example3</span> <span class="o">=</span> <span class="nx">Class</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
    <span class="nx">$extends</span><span class="o">:</span> <span class="nx">Example1</span>
    <span class="nx">$statics</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">bar</span><span class="o">:</span> <span class="s1">'bye'</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">Example4</span> <span class="o">=</span> <span class="nx">Class</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
    <span class="nx">$extends</span><span class="o">:</span> <span class="nx">Example2</span>
    <span class="nx">$statics</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">bar</span><span class="o">:</span> <span class="s1">'bye'</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="nx">Example3</span><span class="p">.</span><span class="nx">foo</span><span class="p">();</span> <span class="c1">// hello</span>
<span class="nx">Example4</span><span class="p">.</span><span class="nx">foo</span><span class="p">();</span> <span class="c1">// bye</span>
</pre></div>

<h3>instanceOf</h3>

<p>The instanceOf function works exactly the same way as the native instanceof except that it also works for interfaces.</p>

<h3>Classes and instances are locked</h3>

<p>By default, constructors and instances are locked. This means that no one can monkey patch your code.
This behaviour can be changed in two ways:</p>

<h4>With the $locked flag:</h4>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">MyUnlockedClass</span> <span class="o">=</span> <span class="nx">Class</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
    <span class="nx">$name</span><span class="o">:</span> <span class="s1">'MyUnlockedClass'</span><span class="p">,</span>
    <span class="nx">$locked</span><span class="o">:</span> <span class="kc">false</span>

    <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">foo</span> <span class="o">=</span> <span class="s1">'bar'</span><span class="p">;</span>           <span class="c1">// Altough the foo property is not declared,</span>
                                    <span class="c1">// it will not throw an error</span>
    <span class="p">},</span>

    <span class="nx">run</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'run!'</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="nx">MyUnlockedClass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">run</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>   <span class="c1">// Methods can be replaced in the prototype</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'im running!'</span><span class="p">);</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">myUnlockedInstance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyUnlockedClass</span><span class="p">();</span>
<span class="nx">myUnlockedInstance</span><span class="p">.</span><span class="nx">undeclaredProperty</span> <span class="o">=</span> <span class="s1">'foo'</span>   <span class="c1">// Properties can be added to the instance</span>
<span class="nx">myUnlockedInstance</span><span class="p">.</span><span class="nx">run</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>          <span class="c1">// Methods can be replaced in the instance</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'im running naked!'</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

<h4>By setting the global option:</h4>

<p>This will change the default behaviour, but classes can still override it with the $locked flag.</p>

<pre><code>dejavu.options.locked = false;
</code></pre>

<p>Note that once a class is unlocked, its subclasses cannot be locked.
Also, although undeclared members are allowed, they will not have their access controlled (they are interpreted as public).</p>

<h3>Notes</h3>

<p>Please avoid using object constructors for strings, objects, booleans and numbers:</p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">MyClass</span> <span class="o">=</span> <span class="nx">Class</span><span class="p">.</span><span class="nx">declare</span><span class="p">({</span>
    <span class="nx">foo</span><span class="o">:</span> <span class="k">new</span> <span class="nb">String</span><span class="p">(</span><span class="s1">'bar'</span><span class="p">),</span>  <span class="c1">// Don't use this</span>
    <span class="nx">foz</span><span class="o">:</span> <span class="s1">'bar'</span>               <span class="c1">// Ok</span>
<span class="p">});</span>
</pre></div>

<h2>Optimizer</h2>

<p>dejavu bundles an optimizer that makes your code faster and lighter.
It specifically:</p>

<ul>
<li>Improves $super and $self usage</li>
<li>Removes all $name and $locked properties because they are not used in the loose version</li>
<li>Removes the need for wrappers, improving performance by a great margin</li>
<li>Removes abstract functions from abstract classes</li>
<li>Removes functions from interfaces</li>
</ul><p>The optimizer is located in the <code>bin</code> folder.
Example usage:</p>

<p><code>node optimizer &lt; file_in.js &gt; file_out.js</code></p>

<p>dejavu also comes with a grunt task.
Bellow is a sample usage copied from a grunt file:</p>

<div class="highlight"><pre>
<span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span><span class="s1">'dejavu'</span><span class="p">);</span>

<span class="nx">grunt</span><span class="p">.</span><span class="nx">initConfig</span><span class="p">({</span>
    <span class="nx">dejavu</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">optimize</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">exclude</span><span class="o">:</span> <span class="p">[</span><span class="sr">/bootstrap(\.min)?\.js$/</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="nx">files</span><span class="o">:</span> <span class="p">{</span>
                <span class="s1">'dist/'</span><span class="o">:</span> <span class="s1">'src/**/*.js'</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>

<h2>Dependencies</h2>

<p>dejavu depends on <a href="https://github.com/millermedeiros/amd-utils">amd-utils</a>.
If you use the regular build, you don't need to worry because all functions used from amd-utils are bundled for you.
If you use it on node, npm will take care of getting the dependencies for you.
If you use the AMD build, you must specify the path to amd-utils.
For example, if you use <a href="http://requirejs.org/">RequireJS</a>:</p>

<div class="highlight"><pre>    <span class="nx">paths</span> <span class="o">:</span> <span class="p">{</span>
        <span class="s1">'amd-utils'</span><span class="o">:</span> <span class="s1">'../vendor/amd-utils/src'</span>
    <span class="p">},</span>

    <span class="nx">packages</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s1">'dejavu'</span>
            <span class="nx">location</span><span class="o">:</span> <span class="s1">'../../dist/amd/strict'</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">]</span>
</pre></div>

<h2>Building dejavu</h2>

<p>Simply run <code>npm install</code> to install all the tools needed.
Then just run <code>npm run-script build</code> or <code>node build</code>.</p>

<h2>Testing dejavu</h2>

<p>Please take a look at the <a href="https://github.com/IndigoUnited/dejavu/tree/master/test">test</a> section.</p>

<h2>License</h2>

<p>Released under the <a href="http://www.opensource.org/licenses/mit-license.php">MIT License</a>.</p>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		          <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-35166457-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>